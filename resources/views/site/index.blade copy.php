<x-layout>
    <section class="slider">
    <div class="slide active">
        <div class="slide-content">
            <h1 class="font-montserratBold">ДОБРО ПОЖАЛОВАТЬ SHAKARIM UNIVERSITY</h1>
        </div>
    </div>
    <div class="slider-nav">
        <button class="prev">❮</button>
        <button class="next">❯</button>
    </div>
    <div class="slider-dots">
        <span class="dot active"></span>
    </div>
</section>

<section class="stats">
    <div class="container">
        <div class="stats-grid">
            <div class="stat-item">
                <div class="icon-circle">
                    <div class="icon"><i class="fas fa-user-graduate"></i></div>
                </div>
                <div class="stat-number">6692</div>
                <div class="stat-name">Студентов</div>
            </div>
            <div class="stat-item">
                <div class="icon-circle">
                    <div class="icon"><i class="fas fa-chalkboard-teacher"></i></div>
                </div>
                <div class="stat-number">354</div>
                <div class="stat-name">ППС</div>
            </div>
            <div class="stat-item">
                <div class="icon-circle">
                    <div class="icon"><i class="fas fa-building"></i></div>
                </div>
                <div class="stat-number">9</div>
                <div class="stat-name">Корпусов</div>
            </div>
            <div class="stat-item">
                <div class="icon-circle">
                    <div class="icon"><i class="fas fa-home"></i></div>
                </div>
                <div class="stat-number">5</div>
                <div class="stat-name">Общежитие</div>
            </div>
        </div>
    </div>
</section>

<!-- Секция каталога -->
<section class="catalog">
    <div class="catalog-grid">
        <!-- Школьникам -->
        <div class="catalog-item" data-bg="/img/bg-child.jpg">
            <a href="https://shakarim.edu.kz/ru/pages/obrazovaniye/lekoteka?pathway=obrazovaniye" class="catalog-link">
                <div class="catalog-bg"></div>
                <div class="catalog-overlay"></div>
                <div class="catalog-title">Школьникам</div>
                <div class="catalog-content">
                    <div class="catalog-separator"></div>
                    <div class="catalog-text">Наша цель — заинтересовать детей наукой и показать, что она тоже может быть занимательной и абсолютно доступной. Познакомившись с университетской жизнью в столь раннем возрасте, Вы поймете, что учиться в университете — это увлекательно.</div>
                </div>
            </a>
        </div>
        
        <!-- Поступающим -->
        <div class="catalog-item" data-bg="/img/bg-enrollee.jpg">
            <a href="https://shakarim.edu.kz/ru/abituriyentam/rector?pathway=abituriyentam" class="catalog-link">
                <div class="catalog-bg"></div>
                <div class="catalog-overlay"></div>
                <div class="catalog-title">Поступающим</div>
                <div class="catalog-content">
                    <div class="catalog-separator"></div>
                    <div class="catalog-text">Если вы хотите приобрести востребованную, гарантирующую стабильный доход специальность, наши двери открыты для вас!</div>
                </div>
            </a>
        </div>
        
        <!-- Обучающимся -->
        <div class="catalog-item" data-bg="/img/bg-teaching.jpg">
            <a href="https://shakarim.edu.kz/ru/pages/obuchayushchimsya/tsentr-obsluzhivaniya-obuchayushchikhsya?path=obuchayushchimsya" class="catalog-link">
                <div class="catalog-bg"></div>
                <div class="catalog-overlay"></div>
                <div class="catalog-title">Обучающимся</div>
                <div class="catalog-content">
                    <div class="catalog-separator"></div>
                    <div class="catalog-text">Вы имеете возможность ознакомиться с информацией, касающейся Вашей академической деятельности, найдете ответы на вопросы о студенческой жизни, учебном процессе, практике, экзаменах, а также много полезной информации.</div>
                </div>
            </a>
        </div>
        
        <!-- Выпускникам -->
        <div class="catalog-item" data-bg="/img/bg-graduate.jpg">
            <a href="https://shakarim.edu.kz/ru/pages/index?pathway=vypusnikam" class="catalog-link">
                <div class="catalog-bg"></div>
                <div class="catalog-overlay"></div>
                <div class="catalog-title">Выпускникам</div>
                <div class="catalog-content">
                    <div class="catalog-separator"></div>
                    <div class="catalog-text">Одной из задач Университета Шакарима является обеспечение конкурентоспособности выпускников. Мы заинтересованы в сотрудничестве с вами во имя процветания и развития нашего университета в рамках деятельности Ассоциации выпускников.</div>
                </div>
            </a>
        </div>
        
        <!-- Работодателям -->
        <div class="catalog-item" data-bg="/img/bg-employer.jpg">
            <a href="https://shakarim.edu.kz/ru/resume/index?pathway=rabotodatelyam" class="catalog-link">
                <div class="catalog-bg"></div>
                <div class="catalog-overlay"></div>
                <div class="catalog-title">Работодателям</div>
                <div class="catalog-content">
                    <div class="catalog-separator"></div>
                    <div class="catalog-text">Мы предлагаем Вам различные формы сотрудничества такие как подбор соискателей на вакантные места, организация встреч с обучающимися, проведение тренингов и мастер-классов, реализация совместных проектов, а также участие в Ярмарке вакансий.</div>
                </div>
            </a>
        </div>
        
        <!-- Серебряный университет -->
        <div class="catalog-item" data-bg="/img/bg-senior-teaching.jpg">
            <a href="https://shakarim.edu.kz/ru/pages/obrazovaniye/serebryanyy?pathway=obrazovaniye" class="catalog-link">
                <div class="catalog-bg"></div>
                <div class="catalog-overlay"></div>
                <div class="catalog-title">Серебряный</div>
                <div class="catalog-content">
                    <div class="catalog-separator"></div>
                    <div class="catalog-text">На базе Университета Шакарима создана новая форма деятельности направленная на повышение качества жизни, социальной активности и профессионального развития граждан взрослого поколения.</div>
                </div>
            </a>
        </div>
    </div>
</section>

<div class="extra-spacer" style="height: 0; clear: both; width: 100%;"></div>

<section class="schools">
    <div class="container" style="max-width: 100%; padding: 0 40px;">
        <h2 style="margin-bottom: 30px;">Школы</h2>
        <div class="schools-grid">
            <!-- Верхний ряд: 6 школ -->
            <div class="top-row">
                <div class="school">
                    <a href="https://rse.faculty.shakarim.kz/ru" style="text-decoration: none; color: inherit;">
                        <div class="school-icon"><i class="fas fa-flask"></i></div>
                        <div class="school-name">Исследовательская школа пищевой инженерии</div>
                    </a>
                </div>
                <div class="school">
                    <a href="https://rsvma.faculty.shakarim.kz/ru" style="text-decoration: none; color: inherit;">
                        <div class="school-icon"><i class="fas fa-leaf"></i></div>
                        <div class="school-name">Исследовательская школа ветеринарии и сельского хозяйства</div>
                    </a>
                </div>
                <div class="school">
                    <a href="https://gsaic.faculty.shakarim.kz/ru" style="text-decoration: none; color: inherit;">
                        <div class="school-icon"><i class="fas fa-microchip"></i></div>
                        <div class="school-name">Высшая школа искусственного интеллекта и строительства</div>
                    </a>
                </div>
                <div class="school">
                    <a href="https://shakarim.edu.kz/ru/structure/shakarim-higher-college?pathway=kolledzh" style="text-decoration: none; color: inherit;">
                        <div class="school-icon"><i class="fas fa-university"></i></div>
                        <div class="school-name">Высший колледж Шакарима</div>
                    </a>
                </div>
                <div class="school">
                    <a href="https://hsp.faculty.shakarim.kz/ru" style="text-decoration: none; color: inherit;">
                        <div class="school-icon"><i class="fas fa-book"></i></div>
                        <div class="school-name">Высшая школа филологии</div>
                    </a>
                </div>
                <div class="school">
                    <a href="https://gspms.faculty.shakarim.kz/ru" style="text-decoration: none; color: inherit;">
                        <div class="school-icon"><i class="fas fa-calculator"></i></div>
                        <div class="school-name">Высшая школа физико-математических наук</div>
                    </a>
                </div>
            </div>
            
            <!-- Нижний ряд: 5 школ -->
            <div class="bottom-row">
                <div class="school">
                    <a href="https://gsns.faculty.shakarim.kz/ru" style="text-decoration: none; color: inherit;">
                        <div class="school-icon"><i class="fas fa-atom"></i></div>
                        <div class="school-name">Высшая школа естественных наук</div>
                    </a>
                </div>
                <div class="school">
                    <a href="https://gse.faculty.shakarim.kz/ru" style="text-decoration: none; color: inherit;">
                        <div class="school-icon"><i class="fas fa-graduation-cap"></i></div>
                        <div class="school-name">Высшая школа образования</div>
                    </a>
                </div>
                <div class="school">
                    <a href="https://shakarim.edu.kz/ru/structure/shakarim-high-school?pathway=universitet" style="text-decoration: none; color: inherit;">
                        <div class="school-icon"><i class="fas fa-school"></i></div>
                        <div class="school-name">Shakarim High School</div>
                    </a>
                </div>
                <div class="school">
                    <a href="https://rspcs.faculty.shakarim.kz/ru" style="text-decoration: none; color: inherit;">
                        <div class="school-icon"><i class="fas fa-vial"></i></div>
                        <div class="school-name">Исследовательская школа физических и химических наук</div>
                    </a>
                </div>
                <div class="school">
                    <a href="https://gsb.faculty.shakarim.kz/ru" style="text-decoration: none; color: inherit;">
                        <div class="school-icon"><i class="fas fa-chart-line"></i></div>
                        <div class="school-name">Высшая школа бизнеса</div>
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- News Section -->
<section class="news-section">
    <div class="container">
        <h2 class="section-title">Новости</h2>
        
        <div class="news-container">
            @foreach ($news as $new)
             <div class="news-item">
                <div class="news-title">{{ $new->{'title_'.app()->getLocale()} }}</div>
                <div class="news-content">
                    <div class="news-image">
                        <img src="{{ $new->getPhoto() }}" alt="News 1">
                    </div>
                    <div class="news-text">
                        {!! $new->shortBody() !!}
                        <a href="{{ route('news.show', ['locale'=>app()->getLocale(),'news'=>$new->slug]) }}" class="news-btn">Подробнее</a>
                    </div>
                </div>
            </div>
            @endforeach
           
        
        </div>
        
        <div class="news-all-btn-container">
            <a href="news/index" class="news-all-btn">Все новости</a>
        </div>
    </div>
</section>

<!-- Секция анонсы -->
<section class="announcements">
    <div class="container">
        <h2>АНОНСЫ И СОБЫТИЯ</h2>
        <div class="announcements-grid">
            <div class="calendar-container">
                <div class="calendar-navigation">
                    <button id="prevMonth"><i class="fas fa-chevron-left"></i></button>
                    <h3 id="currentMonth">Май 2025</h3>
                    <button id="nextMonth"><i class="fas fa-chevron-right"></i></button>
                </div>
                <div id="calendar"></div>
            </div>
            <div class="announcements-list">
                @foreach ($events as $event)
                <div class="announcement-item">
                    <div class="announcement-date">{{ $event->getFormattedDate() }}</div>
                    <a href="announcements/all-announcements" class="announcement-title">{{ $event->{'title_'.app()->getLocale()} }}</a>
                </div>
                @endforeach
                
               
                <div class="show-more-container">
                    <a href="announcements/all-announcements" class="show-more-btn">Показать еще</a>
                </div>
            </div>
        </div>
    </div>
</section>

@push('scripts')

<script>
    

//     console.log(calendarEvents);


//     calendarEvents.forEach(event => {
//             events.push({
//                 title: event.title_kk,
//                 start: event.date,
//                 url: '',
//                 color: event.color || '#4285F4', // Цвет по умолчанию
//                 classNames: event.classNames || []
//             });
//         });

    document.addEventListener('DOMContentLoaded', function() {
    // ------------- ИНИЦИАЛИЗАЦИЯ СЛАЙДЕРА -------------
    // Получаем все слайды
    const slides = document.querySelectorAll('.slide');
    let currentSlide = 0;

    // Создаем индикаторы (точки) на основе количества слайдов
    const dotsContainer = document.querySelector('.slider-dots');
    slides.forEach((_, index) => {
        const dot = document.createElement('span');
        dot.classList.add('dot');
        // Активируем первую точку
        if (index === 0) dot.classList.add('active');
        // Добавляем обработчик клика для переключения слайдов
        dot.addEventListener('click', () => goToSlide(index));
        dotsContainer.appendChild(dot);
    });
    
    /**
     * Функция переключения слайдов
     * @param {number} n - Индекс слайда для показа
     */
    function goToSlide(n) {
        // Убираем активный класс с текущего слайда и точки
        slides[currentSlide].classList.remove('active');
        document.querySelectorAll('.dot')[currentSlide].classList.remove('active');
        
        // Вычисляем новый индекс с учетом цикличности
        currentSlide = (n + slides.length) % slides.length;
        
        // Добавляем активный класс новому слайду и точке
        slides[currentSlide].classList.add('active');
        document.querySelectorAll('.dot')[currentSlide].classList.add('active');
    }
    
    // Кнопки управления слайдером (вперед/назад)
    document.querySelector('.next').addEventListener('click', () => goToSlide(currentSlide + 1));
    document.querySelector('.prev').addEventListener('click', () => goToSlide(currentSlide - 1));
    
    // Автоматическое переключение слайдов каждые 5 секунд
    setInterval(() => goToSlide(currentSlide + 1), 5000);
    
    // ------------- КНОПКА ПРОКРУТКИ ВВЕРХ -------------
    const scrollTopBtn = document.getElementById('scrollTopBtn');
    if (scrollTopBtn) {
        window.addEventListener('scroll', function() {
            if (window.pageYOffset > 300) {
                scrollTopBtn.classList.add('visible');
            } else {
                scrollTopBtn.classList.remove('visible');
            }
        });
        scrollTopBtn.addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
    }
    
    // ------------- ИНИЦИАЛИЗАЦИЯ ДОПОЛНИТЕЛЬНЫХ МОДУЛЕЙ -------------
    // Эффект при наведении на блоки школ
    initSchoolsHover();
    
    // Анимация прокрутки новостей
    initNewsScrollAnimation();
    
    // Инициализация календаря
    initCalendar();
});

/**
 * Инициализация и настройка FullCalendar
 * Создает интерактивный календарь с событиями, праздниками и всплывающими подсказками
 */
function initCalendar() {
 
    // Получаем элемент календаря
    const calendarEl = document.getElementById('calendar');
    
     var calendar = new FullCalendar.Calendar(calendarEl, {
      initialView: 'dayGridMonth',
      events: '/events', // Laravel route
      headerToolbar: false,        // Отключаем встроенную навигацию, используем свою
        locale: 'ru',                // Локализация
        height: 'auto',              // Автоматическая высота календаря
        expandRows: true,            // Расширяем строки для заполнения всей высоты
        fixedWeekCount: false,       // Позволяем показывать только нужное количество недель
    });

    calendar.render();
    
    // Рендерим календарь
    calendar.render();
    
    // После рендеринга добавляем звездочки и всплывающие подсказки
    setTimeout(() => {
        // Добавляем звездочки к датам с событиями
        addAsterisksToEvents(calendar);
        
        // Добавляем всплывающие подсказки к дням
        addTooltipsToCalendarDays(calendar);
    }, 100);
    
    /**
     * Функция для добавления звездочек к датам с событиями
     * @param {Object} calendar - Экземпляр FullCalendar
     */
    function addAsterisksToEvents(calendar) {
        // Получаем все события календаря
        const events = calendar.getEvents();
        const eventDates = {};
        
        // Отмечаем даты, на которые есть события с отметкой event-with-asterisk
        events.forEach(event => {
            if (event.display === 'background' && event.classNames.includes('event-with-asterisk')) {
                const eventDate = event.startStr.split('T')[0];
                eventDates[eventDate] = true;
            }
        });
        
        // Перебираем все отмеченные даты и добавляем звездочки
        Object.keys(eventDates).forEach(date => {
            const dateCell = document.querySelector(`.fc-daygrid-day[data-date="${date}"]`);
            if (dateCell && !dateCell.classList.contains('has-asterisk')) {
                dateCell.classList.add('has-asterisk');
                
                if (!dateCell.querySelector('.event-asterisk')) {
                    const asterisk = document.createElement('span');
                    asterisk.className = 'event-asterisk';
                    asterisk.textContent = '*';
                    asterisk.title = 'Есть события в этот день';
                    dateCell.appendChild(asterisk);
                    
                    asterisk.addEventListener('click', function(e) {
                        e.stopPropagation();
                        window.location.href = 'https://shakarim.edu.kz/ru/announcement/index';
                    });
                }
            }
        });
    }
    
    /**
     * Функция для добавления всплывающих подсказок к дням календаря
     * @param {Object} calendar - Экземпляр FullCalendar
     */
    function addTooltipsToCalendarDays(calendar) {
        // Получаем все события календаря
        const events = calendar.getEvents();
        
        // Группируем события по датам
        const eventsByDate = {};
        
        // Добавляем данные о праздничных днях
        const holidayDates = {
            '2025-05-01': 'День единства народа Казахстана',
            '2025-05-07': 'День защитника Отечества',
            '2025-05-09': 'День Победы'
        };
        
        // Обрабатываем обычные события из календаря
        events.forEach(event => {
            const eventStart = event.start;
            
            // Если нет даты начала, пропускаем
            if (!eventStart) return;
            
            // Форматируем дату в YYYY-MM-DD
            const dateStr = eventStart.toISOString().split('T')[0];
            
            // Инициализируем массив событий для этой даты, если его еще нет
            if (!eventsByDate[dateStr]) {
                eventsByDate[dateStr] = [];
            }
            
            // Добавляем событие в список
            eventsByDate[dateStr].push({
                title: event.title,
                type: event.classNames && event.classNames.includes('thin-event') ? 'session' : 'regular',
                time: eventStart.toTimeString().substring(0, 5) // Формат HH:MM
            });
        });
        
        // Добавляем праздничные дни в общий список событий
        Object.keys(holidayDates).forEach(dateStr => {
            if (!eventsByDate[dateStr]) {
                eventsByDate[dateStr] = [];
            }
            
            // Добавляем праздник в начало списка событий
            eventsByDate[dateStr].unshift({
                title: holidayDates[dateStr],
                type: 'holiday'
            });
        });
        
        // Добавляем всплывающие подсказки ко всем дням с событиями
        Object.keys(eventsByDate).forEach(dateStr => {
            const dayEvents = eventsByDate[dateStr];
            if (dayEvents.length > 0) {
                const dateCell = document.querySelector(`.fc-daygrid-day[data-date="${dateStr}"]`);
                if (dateCell) {
                    dateCell.classList.add('has-tooltip');
                    
                    // Создаем содержимое всплывающей подсказки
                    const tooltip = document.createElement('div');
                    tooltip.className = 'day-tooltip';
                    
                    // Добавляем заголовок с датой
                    const date = new Date(dateStr);
                    const formattedDate = date.toLocaleDateString('ru-RU', {
                        day: 'numeric',
                        month: 'long',
                        year: 'numeric'
                    });
                    
                    const tooltipHeader = document.createElement('h4');
                    tooltipHeader.textContent = `События на ${formattedDate}`;
                    tooltip.appendChild(tooltipHeader);
                    
                    // Добавляем список событий
                    const eventsList = document.createElement('ul');
                    dayEvents.forEach(event => {
                        const eventItem = document.createElement('li');
                        eventItem.className = `${event.type}-event`;
                        
                        if (event.time) {
                            eventItem.textContent = `${event.title} (${event.time})`;
                        } else {
                            eventItem.textContent = event.title;
                        }
                        
                        eventsList.appendChild(eventItem);
                    });
                    tooltip.appendChild(eventsList);
                    
                    // Добавляем всплывающую подсказку к ячейке
                    dateCell.appendChild(tooltip);
                    
                    // Добавляем обработчики событий для показа/скрытия подсказки с адаптивным позиционированием
                    dateCell.addEventListener('mouseenter', function() {
                        // Показываем сначала невидимо, чтобы вычислить размеры
                        tooltip.style.visibility = 'hidden';
                        tooltip.style.display = 'block';
                        
                        // Получаем размеры и позиции
                        const tooltipRect = tooltip.getBoundingClientRect();
                        const cellRect = dateCell.getBoundingClientRect();
                        const calendarRect = document.getElementById('calendar').getBoundingClientRect();
                        const viewportHeight = window.innerHeight;
                        const viewportWidth = window.innerWidth;
                        
                        // Для дат в нижней половине календаря приоритетно показываем тултип сверху
                        const isInLowerHalf = cellRect.top > calendarRect.top + (calendarRect.height / 2);
                        
                        // Выбираем вертикальное положение (сверху или снизу)
                        let position = 'bottom';
                        if (isInLowerHalf || (viewportHeight - cellRect.bottom < tooltipRect.height && cellRect.top > tooltipRect.height)) {
                            position = 'top';
                        }
                        
                        // Выбираем горизонтальное положение (по центру, справа или слева)
                        let alignment = 'center';
                        if (cellRect.left + (tooltipRect.width / 2) > viewportWidth) {
                            alignment = 'right';
                        } else if (cellRect.left - (tooltipRect.width / 2) < 0) {
                            alignment = 'left';
                        }
                        
                        // Очищаем предыдущие классы позиционирования
                        tooltip.classList.remove('position-top', 'position-bottom', 'align-left', 'align-center', 'align-right');
                        
                        // Добавляем нужные классы
                        tooltip.classList.add(`position-${position}`, `align-${alignment}`);
                        
                        // Делаем подсказку видимой после настройки позиции
                        tooltip.style.visibility = 'visible';
                    });
                    
                    dateCell.addEventListener('mouseleave', function() {
                        tooltip.style.display = 'none';
                    });
                }
            }
        });
    }
    
    // При изменении размера окна обновляем всплывающие подсказки
    window.addEventListener('resize', function() {
        // Удаляем старые подсказки и создаем новые
        setTimeout(() => {
            document.querySelectorAll('.day-tooltip').forEach(tooltip => tooltip.remove());
            addAsterisksToEvents(calendar);
            addTooltipsToCalendarDays(calendar);
        }, 100);
    });
    
    // Настройка кнопок навигации календаря
    const prevMonthBtn = document.getElementById('prevMonth');
    const nextMonthBtn = document.getElementById('nextMonth');
    const currentMonthEl = document.getElementById('currentMonth');
    
    if (prevMonthBtn && nextMonthBtn && currentMonthEl) {
        // Переход на предыдущий месяц
        prevMonthBtn.addEventListener('click', function() {
            calendar.prev();
            updateMonthDisplay();
            
            // Обновляем подсказки при смене месяца
            setTimeout(() => {
                document.querySelectorAll('.day-tooltip').forEach(tooltip => tooltip.remove());
                addAsterisksToEvents(calendar);
                addTooltipsToCalendarDays(calendar);
            }, 100);
        });
        
        // Переход на следующий месяц
        nextMonthBtn.addEventListener('click', function() {
            calendar.next();
            updateMonthDisplay();
            
            // Обновляем подсказки при смене месяца
            setTimeout(() => {
                document.querySelectorAll('.day-tooltip').forEach(tooltip => tooltip.remove());
                addAsterisksToEvents(calendar);
                addTooltipsToCalendarDays(calendar);
            }, 100);
        });
        
        /**
         * Функция для обновления заголовка с названием месяца и годом
         */
        function updateMonthDisplay() {
            const date = calendar.getDate();
            const locale = 'ru';
            
            // Форматирование месяца и года
            const monthName = date.toLocaleString(locale, { month: 'long' });
            const year = date.getFullYear();
            
            // Установка заголовка с учетом склонения в русском языке
            let formattedMonth = monthName.charAt(0).toUpperCase() + monthName.slice(1);
            currentMonthEl.textContent = `${formattedMonth} ${year}`;
        }
        
        // Инициализация заголовка при загрузке
        updateMonthDisplay();
    }
}

/**
 * Добавляет интерактивность к новостным блокам
 * Создает эффекты при наведении и взаимодействии
 */
function initNewsItems() {
    const newsItems = document.querySelectorAll('.news-item');
    
    newsItems.forEach(item => {
        // Добавляем анимацию при наведении
        item.addEventListener('mouseenter', function() {
            newsItems.forEach(otherItem => {
                if (otherItem !== item) {
                    otherItem.style.opacity = '0.7';
                    otherItem.style.transform = 'scale(0.98)';
                }
            });
        });
        
        // Возвращаем исходное состояние при убирании курсора
        item.addEventListener('mouseleave', function() {
            newsItems.forEach(otherItem => {
                otherItem.style.opacity = '';
                otherItem.style.transform = '';
            });
        });
    });
}

/**
 * Инициализирует анимацию счетчиков статистики
 * Запускает счетчики при прокрутке до блока статистики
 */
function initStatsCounter() {
    const stats = document.querySelectorAll('.stat-number');
    let counted = false;
                        
    /**
     * Функция анимации счетчика
     * @param {Element} target - Целевой элемент для анимации
     * @param {number} start - Начальное значение
     * @param {number} end - Конечное значение
     * @param {number} duration - Длительность анимации в мс
     */
    function animateCounter(target, start, end, duration) {
        let startTime = null;
        
        // Функция анимации
        function animation(currentTime) {
            if (!startTime) startTime = currentTime;
            const progress = Math.min((currentTime - startTime) / duration, 1);
            const value = Math.floor(progress * (end - start) + start);
            target.textContent = value;
            
            if (progress < 1) {
                window.requestAnimationFrame(animation);
            }
        }
        
        window.requestAnimationFrame(animation);
    }
    
    /**
     * Проверяет, виден ли блок статистики в области просмотра
     * и запускает анимацию при необходимости
     */
    function checkScroll() {
        if (counted) return;
        
        const windowHeight = window.innerHeight;
        const statsSection = document.querySelector('.stats');
        
        if (!statsSection) return;
        
        const statsSectionTop = statsSection.getBoundingClientRect().top;
        const statsSectionBottom = statsSection.getBoundingClientRect().bottom;
        
        if (statsSectionTop < windowHeight && statsSectionBottom > 0) {
            counted = true;
            
            stats.forEach(stat => {
                const target = parseInt(stat.textContent, 10);
                animateCounter(stat, 0, target, 2000);
            });
        }
    }
    
    // Добавляем обработчик прокрутки
    window.addEventListener('scroll', checkScroll);
                            
    // Проверяем при начальной загрузке
    checkScroll();
}

/**
 * Инициализирует эффекты при наведении на блоки школ
 */
function initSchoolsHover() {
    const schools = document.querySelectorAll('.school');
    
    schools.forEach(school => {
        // Затемняем другие школы при наведении на одну
        school.addEventListener('mouseenter', function() {
            schools.forEach(s => {
                if (s !== school) {
                    s.style.opacity = '0.6';
                }
            });
        });
        
        // Возвращаем исходное состояние при убирании курсора
        school.addEventListener('mouseleave', function() {
            schools.forEach(s => {
                s.style.opacity = '';
            });
        });
    });
}

/**
 * Инициализирует анимацию при прокрутке новостных блоков
 * Новости открываются при достижении середины экрана
 */
function initNewsScrollAnimation() {
    const newsItems = document.querySelectorAll('.news-item');
    
    /**
     * Обновляет состояние анимации новостных блоков при прокрутке
     */
    function updateNewsAnimation() {
        newsItems.forEach((item) => {
            const rect = item.getBoundingClientRect();
            const windowHeight = window.innerHeight;
            const middleScreen = windowHeight / 2;
            
            // Проверяем, достигла ли верхняя часть новости середины экрана
            // и нижняя часть все еще видна
            if (rect.top <= middleScreen && rect.bottom >= 0) {
                // Элемент виден и верхняя часть достигла середины экрана
                item.style.setProperty('--open-progress', '1');
            } else {
                // Элемент не виден или верхняя часть еще не достигла середины
                item.style.setProperty('--open-progress', '0');
            }
        });
    }
    
    // Первоначальное обновление анимации
    updateNewsAnimation();
    
    // Обновление при прокрутке
    window.addEventListener('scroll', updateNewsAnimation);
} 
</script>

@endpush

</x-layout>